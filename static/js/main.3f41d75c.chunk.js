(this.webpackJsonpbaza_pytan_react=this.webpackJsonpbaza_pytan_react||[]).push([[0],{50:function(e,t,n){e.exports=n(82)},55:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),i=n(24),o=n.n(i),r=(n(55),n(6)),c=n(7),l=n(9),u=n(10),m=n(42),d=n(11),p=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={value:"",showClose:!1},e.onChange=function(t){var n=t.target.value.split(",").map((function(e){return e.trim()}));e.props.onChange(n),t.target.value.length>1?e.setState({value:t.target.value,showClose:!0}):e.setState({value:t.target.value,showClose:!1})},e.resetFilter=function(){e.setState({value:"",showClose:!1}),e.props.onChange([])},e}return Object(c.a)(n,[{key:"render",value:function(){return s.a.createElement("div",{className:"filter"},s.a.createElement("div",{className:"filter__text"},s.a.createElement(m.a,{className:"filter__icon"})," Szukaj!"," "),s.a.createElement("input",{className:"filter__input js--filter-input",type:"text",placeholder:this.props.placeholder,onChange:this.onChange,value:this.state.value}),this.state.showClose?s.a.createElement(d.b,{className:"filter__close",onClick:this.resetFilter}):null)}}]),n}(a.Component),h=function(e){var t="btn ";return e.className&&(t+=e.className+" "),e.type&&(t+="btn--"+e.type+" "),e.types&&e.types.forEach((function(e){t+="btn--"+e+" "})),s.a.createElement("button",{onClick:e.onClick,className:t},e.children)},f=function(e){var t=s.a.createElement(a.Fragment,null,s.a.createElement("button",{className:"question-card__delete-btn",onClick:e.onDelete},s.a.createElement("div",null)),s.a.createElement("button",{className:"question-card__edit-btn",onClick:e.onEdit},s.a.createElement(d.e,null)));return s.a.createElement("div",{className:"question-card"},s.a.createElement("h2",{className:"question-card__title"},e.question),s.a.createElement("p",{className:"question-card__answer"},e.answer),s.a.createElement("div",{className:"question-card__key-words-title"},"S\u0142owa kluczowe:"),s.a.createElement("div",{className:"question-card__key-words"},e.keyWords&&e.keyWords.map&&e.keyWords.length>0?e.keyWords.map((function(e,t){return!e||e.length<1?null:s.a.createElement("div",{key:e+""+t,className:"question-card__key-word"},e)})):s.a.createElement("div",{className:"question-card__key-word--default"},"Brak s\u0142\xf3w kluczowych")),e.isDeletable?t:null)},E=function(){return s.a.createElement("div",{className:"lds-ring"},s.a.createElement("div",null),s.a.createElement("div",null),s.a.createElement("div",null),s.a.createElement("div",null))},b=n(21),g=n(8),_=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={question:"",answer:"",keyWordsString:"",keyWords:[]},e.setInputsFromProps=function(){e.setState({question:e.props.question||"",answer:e.props.answer||"",keyWordsString:e.props.keyWords&&e.props.keyWords.join?e.props.keyWords.join(","):"",keyWords:e.props.keyWords||[]})},e.onInputChange=function(t,n){e.setState(Object(b.a)({},n,t.target.value))},e.onKeyWordsChange=function(t){var n=t.target.value.split(",").map((function(e){return e.trim()}));e.setState({keyWordsString:t.target.value,keyWords:n})},e.onSubmit=function(t){if(t.preventDefault(),e.props.user){var n={question:e.state.question,answer:e.state.answer,keyWords:e.state.keyWords};e.props.onSubmit(n)}else console.error("Cant send question if not logged in!")},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.setInputsFromProps()}},{key:"componentDidUpdate",value:function(){this.state.question||this.state.answer||this.state.keyWordsString||!(this.props.question||this.props.answer||this.props.keyWords)||this.setInputsFromProps()}},{key:"render",value:function(){var e=this;return s.a.createElement("form",{className:"question-card",onSubmit:this.onSubmit},s.a.createElement("input",{className:"question-card__title question-card__title--input",placeholder:"Tre\u015b\u0107 pytania...",value:this.state.question,onChange:function(t){return e.onInputChange(t,"question")},required:!0}),s.a.createElement("textarea",{className:"question-card__answer question-card__answer--input",placeholder:"Tre\u015b\u0107 odpowiedzi...",value:this.state.answer,onChange:function(t){return e.onInputChange(t,"answer")},required:!0}),s.a.createElement("div",{className:"question-card__key-words-title"},"S\u0142owa kluczowe:"),s.a.createElement("textarea",{className:"question-card__key-words question-card__key-words--input",placeholder:"S\u0142owa kluczowe oddzielone przecinkami",onChange:this.onKeyWordsChange,value:this.state.keyWordsString}),s.a.createElement("button",{className:"question-card__btn",type:"submit"},"Wy\u015blij!"),s.a.createElement("button",{className:"question-card__delete-btn",onClick:this.props.onClose},s.a.createElement("div",null)))}}]),n}(a.Component),y=Object(g.b)((function(e){return{user:e.auth.user}}),{})(_),v=function(e){var t=s.a.createElement("span",{className:"u-centered"},s.a.createElement(E,null)),n=s.a.createElement("h3",{className:"u-centered"},"Nie znaleziono \u017cadnych pyta\u0144.");return s.a.createElement("div",{className:"questions-container"},0===e.questions.length?e.showLoader?t:n:null,e.questions.map((function(t,n){return e.editedPosition===n?s.a.createElement(y,{question:t.question,answer:t.answer,keyWords:t.keyWords,key:t.id,onClose:e.methods.onClose,onSubmit:function(n){return e.methods.onSubmit(n,t.id)}}):s.a.createElement(f,{key:t.id,id:t.id,question:t.question,answer:t.answer,keyWords:t.keyWords,onDelete:function(){return e.onDeleteQuestion(t.id)},onEdit:function(){return e.onEditQuestion(t.id)},isDeletable:!1!==t.isDeletable})})))},N=n(2),w=n.n(N),k=n(44);n(67),n(38),n(70);w.a.initializeApp({apiKey:"AIzaSyAwlN24oXYrAEceYn1XB3fpAHi5cEFqzNw",authDomain:"baza-pytan.firebaseapp.com",databaseURL:"https://baza-pytan.firebaseio.com",projectId:"baza-pytan",storageBucket:"baza-pytan.appspot.com",messagingSenderId:"361765519780",appId:"1:361765519780:web:18b81c5a7f7f3257d6c131"});w.a.auth.GoogleAuthProvider.PROVIDER_ID,w.a.auth.FacebookAuthProvider.PROVIDER_ID,new k.a.AuthUI(w.a.auth());var O=w.a.database(),C=w.a.auth(),j=w.a.functions(),S=n(4),A=function(e,t){return{type:"GET_ERRORS",payload:{msg:e,status:t}}},U=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).defaultQuestionsPerPage=4,e.state={filterInput:[],addingQuestion:!1,isFiltering:!1,numOfQuestions:e.defaultQuestionsPerPage,type:"public",editedPosition:null},e.loadQuestions=function(t){switch(t){case"private":if(!e.props.user)return void e.props.history.push("/");e.props.user.uid&&e.props.fetchMyReviewQuestions(e.props.user.uid);break;case"review":if(!e.props.user||!e.props.isPublisher)return void e.props.history.push("/");e.props.fetchAllReviewQuestions();break;default:e.props.fetchPublicQuestions()}e.resetEditingQuestion(),e.resetQuestionsNum()},e.onAddingQuestion=function(){e.setState({addingQuestion:!0})},e.onEndAddQuestion=function(){e.setState({addingQuestion:!1})},e.onAddedQuestion=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.props.user&&e.props.user.uid&&("private"===e.state.type?n?e.props.updateQuestion(n,"reviewQuestions",t):e.props.createReviewQuestion(t,e.props.user.uid):n?e.props.updateQuestion(n,"publicQuestions",t):e.props.createPublicQuestion(t,e.props.user.uid),e.onEndAddQuestion(),e.resetEditingQuestion())},e.loadMoreQuestions=function(){var t=e.state.numOfQuestions;e.setState({numOfQuestions:t+3})},e.resetQuestionsNum=function(){e.state.numOfQuestions!==e.defaultQuestionsPerPage&&e.setState({numOfQuestions:e.defaultQuestionsPerPage})},e.onFilterChange=function(t){t.length&&t[0].length>1?e.setState({filterInput:t,isFiltering:!0}):e.setState({filterInput:t,isFiltering:!1})},e.onDeleteQuestion=function(t){switch(e.state.type){case"private":e.props.deleteQuestion(t,"reviewQuestions");break;case"review":if(!e.props.isPublisher)return;e.props.deleteQuestion(t,"reviewQuestions");break;default:if(!e.props.isPublisher)return;e.props.deleteQuestion(t,"publicQuestions")}},e.onEditedQuestion=function(t){var n=e.props.questions.findIndex((function(e){return e.id===t}));e.setState({editedPosition:n})},e.resetEditingQuestion=function(){e.setState({editedPosition:null})},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.loadQuestions(this.props.type),this.props.type&&this.setState({type:this.props.type})}},{key:"componentDidUpdate",value:function(){console.log(this.props.questions),this.props.type!==this.state.type&&(this.setState({type:this.props.type}),this.loadQuestions(this.props.type))}},{key:"render",value:function(){var e=this,t=s.a.createElement(h,{onClick:this.loadMoreQuestions,className:this.state.numOfQuestions>=this.props.questions.length?"btn--grey":""},"Za\u0142aduj wi\u0119cej pyta\u0144");!this.props.isAdmin&&"private"!==this.state.type||"review"===this.state.type||(t=s.a.createElement("div",{className:"questions-box__btns"},s.a.createElement(h,{onClick:this.onAddingQuestion},"Dodaj pytanie"),s.a.createElement(h,{onClick:this.loadMoreQuestions,className:this.state.numOfQuestions>=this.props.questions.length?"btn--grey":""},"Za\u0142aduj wi\u0119cej pyta\u0144")));var n=this.props.questions.filter((function(t){if(0===e.state.filterInput.length)return!0;if(e.state.filterInput[0].length<2)return!0;e.resetQuestionsNum();var n=!1;return t.keyWords&&t.keyWords.forEach&&t.keyWords.forEach((function(t){e.state.filterInput.forEach((function(e){t.toLowerCase().includes(e.toLowerCase())&&e.length>1&&(n=!0)}))})),e.state.filterInput.forEach((function(e){t.question&&t.question.toLowerCase().includes(e.toLowerCase())&&e.length>1&&(n=!0)})),n}));n&&n.length>this.state.numOfQuestions&&n.splice(this.state.numOfQuestions);var i=null;this.state.addingQuestion&&(i=s.a.createElement(y,{onClose:this.onEndAddQuestion,onSubmit:this.onAddedQuestion}));var o=s.a.createElement(v,{questions:n,onDeleteQuestion:this.onDeleteQuestion,onEditQuestion:this.onEditedQuestion,showLoader:!this.state.isFiltering});return(this.state.editedPosition||0===this.state.editedPosition)&&(o=s.a.createElement(v,{questions:n,onDeleteQuestion:this.onDeleteQuestion,onEditQuestion:this.onEditedQuestion,showLoader:!this.state.isFiltering,editedPosition:this.state.editedPosition,methods:{onClose:this.resetEditingQuestion,onSubmit:this.onAddedQuestion}})),console.log(this.props.questions),console.log(n),s.a.createElement(a.Fragment,null,s.a.createElement(p,{placeholder:"Szukaj pyta\u0144 po s\u0142owach kluczowych...",onChange:this.onFilterChange}),o,i,t)}}]),n}(a.Component),I=Object(g.b)((function(e){return{questions:e.questions.items,isAuthenticated:e.auth.isAuthenticated,user:e.auth.user,isPublisher:e.auth.isPublisher,isAdmin:e.auth.isAdmin}}),{fetchPublicQuestions:function(){return function(e){O.ref("publicQuestions").once("value").then((function(e){return e.val()})).then((function(t){console.log("PUBLIC:",t);var n=[];for(var a in t)n.push(Object(S.a)({},t[a],{id:a,isDeletable:!1}));e({type:"FETCH_QUESTIONS",payload:n})})).catch((function(t){e(A(t.message,t.code)),e({type:"QUESTION_ERROR"})}))}},deleteQuestion:function(e,t){return function(n){O.ref("".concat(t,"/").concat(e)).remove((function(t){n({type:"DELETE_QUESTION",payload:e})})).catch((function(e){n(A(e.message,e.code)),n({type:"QUESTION_ERROR"})}))}},fetchMyReviewQuestions:function(e){return function(t){console.log("GETTING Q FROM: ",e),e?O.ref("reviewQuestions").orderByChild("uid").equalTo(e).once("value").then((function(e){return e.val()})).then((function(e){console.log(e);var n=[];for(var a in e)n.push(Object(S.a)({},e[a],{id:a,isDeletable:!0}));t({type:"FETCH_QUESTIONS",payload:n})})).catch((function(e){t(A(e.message,e.code)),t({type:"QUESTION_ERROR"})})):console.error("Getting questions without beeing authenticated!")}},fetchAllReviewQuestions:function(){return function(e){O.ref("reviewQuestions").once("value").then((function(e){return e.val()})).then((function(t){console.log(t);var n=[];for(var a in t)n.push(Object(S.a)({},t[a],{id:a,isDeletable:!0}));e({type:"FETCH_QUESTIONS",payload:n})})).catch((function(t){e(A(t.message,t.code)),e({type:"QUESTION_ERROR"})}))}},createPublicQuestion:function(e,t){return function(n){console.log("SENDER",t),e.id||console.error("CANT MAKE QUESTION PUBLIC WITHOUT ITS ID");var a=O.ref("publicQuestions").push();a.set({question:e.question,answer:e.answer,keyWords:e.keyWords||[],uid:t.uid||"brak danych",author:e.uid||"brak danych",createdAt:Date.now()}).then((function(t){var s=Object(S.a)({},e);s.id=a.key,n({type:"NEW_PUBLIC_QUESTION",payload:s})})).catch((function(e){n(A(e.message,e.code)),n({type:"QUESTION_ERROR"})}))}},createReviewQuestion:function(e,t){return function(n){console.log("SENDER",t);var a=O.ref("reviewQuestions").push();a.set({question:e.question,answer:e.answer,keyWords:e.keyWords||[],uid:t.uid,creator:{firstName:t.firstName||"Brak informacji",lastName:t.lastName||"Brak informacji",email:t.email||"Nie podano"},createdAt:Date.now()}).then((function(t){var s=Object(S.a)({},e);s.id=a.key,n({type:"NEW_PRIVATE_QUESTION",payload:s})})).catch((function(e){n(A(e.message,e.code)),n({type:"QUESTION_ERROR"})}))}},updateQuestion:function(e,t,n){return function(a){O.ref("".concat(t,"/").concat(e)).update(Object(S.a)({},n)).then((function(){a({type:"UPDATE_QUESTION",payload:{id:e,question:n}})})).catch((function(e){a(A(e.message,e.code)),a({type:"QUESTION_ERROR"})}))}}})(U),Q=function(){return s.a.createElement("footer",{className:"footer"},s.a.createElement("h3",{className:"footer__link"},"\xa9 Jan Radzimi\u0144ski 2020"))},R=n(16),P=n(13),q=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={value:""},e.onChange=function(t){e.setState({value:t.target.value}),e.props.onChange(t)},e}return Object(c.a)(n,[{key:"render",value:function(){return s.a.createElement("div",{className:"login__input-box"},s.a.createElement("input",{type:this.props.type,className:"login__input",id:this.props.id,placeholder:this.props.placeholder,onChange:this.onChange,value:this.state.value,name:this.props.id,required:this.props.required}),s.a.createElement("label",{htmlFor:this.props.id,className:"login__label"},this.props.label),this.props.icon)}}]),n}(a.Component),D=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={register:!1,email:"",password:"",firstName:"",lastName:"",city:""},e.onChangeFormType=function(t){e.setState({register:!0===t})},e.onSubmit=function(t){t.preventDefault(),e.state.register?e.props.registerUser({email:e.state.email,password:e.state.password,firstName:e.state.firstName,lastName:e.state.lastName,city:e.state.city}):e.props.loginUser(e.state.email,e.state.password),e.props.isLoading||e.props.history.push("/")},e.onInputChange=function(t){t.target&&e.setState(Object(b.a)({},t.target.name,t.target.value))},e}return Object(c.a)(n,[{key:"componentDidUpdate",value:function(){this.props.isAuthenticated&&this.props.history.push("/")}},{key:"render",value:function(){var e=this,t=s.a.createElement("div",{className:"login__btns"},s.a.createElement("button",{type:"button",className:"login__btn",onClick:function(){return e.onChangeFormType(!1)}},"Zaloguj si\u0119"),s.a.createElement("button",{type:"button",className:"login__btn login__btn--grey",onClick:function(){return e.onChangeFormType(!0)}},"Zarejestruj si\u0119")),n="Login";this.state.register&&(t=s.a.createElement("div",{className:"login__btns"},s.a.createElement("button",{type:"button",className:"login__btn  login__btn--grey",onClick:function(){return e.onChangeFormType(!1)}},"Zaloguj si\u0119"),s.a.createElement("button",{type:"button",className:"login__btn",onClick:function(){return e.onChangeFormType(!0)}},"Zarejestruj si\u0119")),n="Rejestracja");var i=s.a.createElement(a.Fragment,null,s.a.createElement(q,{type:"text",id:"email",placeholder:"Email",onChange:this.onInputChange,label:"Email:",icon:s.a.createElement(P.c,{className:"login__icon"}),required:!0}),s.a.createElement(q,{type:"password",id:"password",placeholder:"Has\u0142o",onChange:this.onInputChange,label:"Has\u0142o:",icon:s.a.createElement(P.b,{className:"login__icon"}),required:!0}));return this.state.register&&(i=s.a.createElement(a.Fragment,null,s.a.createElement(q,{type:"text",id:"firstName",placeholder:"Imi\u0119",onChange:this.onInputChange,label:"Imi\u0119:",icon:s.a.createElement(P.c,{className:"login__icon"}),required:!0}),s.a.createElement(q,{type:"text",id:"lastName",placeholder:"Nazwisko",onChange:this.onInputChange,label:"Nazwisko:",icon:s.a.createElement(P.c,{className:"login__icon"}),required:!0}),s.a.createElement(q,{type:"text",id:"email",placeholder:"Email",onChange:this.onInputChange,label:"Email:",icon:s.a.createElement(d.d,{className:"login__icon"}),required:!0}),s.a.createElement(q,{type:"password",id:"password",placeholder:"Has\u0142o",onChange:this.onInputChange,label:"Has\u0142o:",icon:s.a.createElement(P.b,{className:"login__icon"}),required:!0}),s.a.createElement(q,{type:"text",id:"city",placeholder:"Miejscowo\u015b\u0107",onChange:this.onInputChange,label:"Miejscowo\u015b\u0107 zamieszkania:",icon:s.a.createElement(d.d,{className:"login__icon"})}))),s.a.createElement("form",{className:"login",onSubmit:this.onSubmit},t,s.a.createElement("h2",{className:"login__title"},n),i,s.a.createElement("button",{type:"submit",className:"btn btn--full"},"Wy\u015blij"))}}]),n}(a.Component),L=Object(g.b)((function(e){return{loading:e.auth.isLoading,isAuthenticated:e.auth.isAuthenticated}}),{loginUser:function(e,t){return function(n){n({type:"USER_LOADING"}),C.signInWithEmailAndPassword(e,t).then((function(e){console.log(e),n({type:"LOGIN_SUCCESS"})})).catch((function(e){n(A(e.message,e.code)),n({type:"LOGIN_FAIL"})}))}},registerUser:function(e){return function(t){C.createUserWithEmailAndPassword(e.email,e.password).then((function(e){return e.user})).then((function(n){O.ref("users/".concat(n.uid)).set({firstName:e.firstName,lastName:e.lastName,email:n.email,city:e.city,isPublisher:!1,isAdmin:!1}),t({type:"REGISTER_SUCCESS"})})).catch((function(e){t(A(e.message,e.code)),t({type:"REGISTER_FAIL"})}))}}})(D),T=n(26),M=n(19),z=Object(R.f)(Object(g.b)((function(e){return{firstName:e.auth.user.firstName,lastName:e.auth.user.lastName}}),{logOut:function(){return function(e){C.signOut().then((function(){e({type:"LOGOUT_SUCCESS"})})).catch((function(t){e(A(t.message,t.code)),e({type:"AUTH_ERROR"})}))}}})((function(e){return s.a.createElement("div",{className:"user-menu",onClick:e.onClick},s.a.createElement("ul",{className:"user-menu__list"},s.a.createElement("li",{className:"user-menu__link"},e.firstName," ",e.lastName),s.a.createElement("li",{className:"user-menu__link",onClick:function(){e.onClick(),e.history.push("/account")}},s.a.createElement(d.a,{className:"user-menu__icon"}),"Twoje konto"),s.a.createElement("li",{className:"user-menu__link"},s.a.createElement(d.e,{className:"user-menu__icon"}),"Zmie\u0144 has\u0142o"),s.a.createElement("li",{className:"user-menu__link",onClick:function(){e.logOut(),e.onClick(),e.history.push("/")}},s.a.createElement(P.a,{className:"user-menu__icon"})," Wyloguj si\u0119")))}))),F=Object(R.f)((function(e){return s.a.createElement("div",{className:"user-nav-bar"},console.log(e.history.location.pathname),s.a.createElement("ul",{className:"user-nav-bar__list"},s.a.createElement("li",{className:"user-nav-bar__link ".concat("/"===e.history.location.pathname?"user-nav-bar__link--active":null),onClick:function(){return e.history.push("/")}},"Wszystkie pytania"),s.a.createElement("li",{className:"user-nav-bar__link ".concat("/prywatne"===e.history.location.pathname?"user-nav-bar__link--active":null),onClick:function(){return e.history.push("/prywatne")}},"Moje pytania"),e.isPublisher||e.isAdmin?s.a.createElement("li",{className:"user-nav-bar__link ".concat("/recenzje"===e.history.location.pathname?"user-nav-bar__link--active":null),onClick:function(){return e.history.push("/recenzje")}},"Pytania do recenzji"):null,e.isAdmin?s.a.createElement("li",{className:"user-nav-bar__link ".concat("/admin"===e.history.location.pathname?"user-nav-bar__link--active":null),onClick:function(){return e.history.push("/admin")}},"Admin"):null))})),x=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={icon:!1,showUserMenu:!1,sticked:!1},e.changeIcon=function(){e.setState({icon:!e.state.icon})},e.showUserMenu=function(){e.setState({showUserMenu:!0})},e.hideUserMenu=function(){e.setState({showUserMenu:!1})},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=null;this.state.showUserMenu&&(t=s.a.createElement(z,{onClick:function(){return e.hideUserMenu()}}));var n=s.a.createElement(M.b,{to:"/login",style:{textDecoration:"none"}},s.a.createElement("button",{className:"btn btn--full btn--small"},"Zaloguj si\u0119"));return this.props.isAuth&&(n=s.a.createElement("div",{className:"nav-bar__user"},s.a.createElement(F,{isAdmin:this.props.isAdmin,isPublisher:this.props.isPublisher}),s.a.createElement("button",{className:"nav-bar__login-btn",onMouseEnter:function(){return e.changeIcon()},onMouseLeave:function(){return e.changeIcon()},onClick:this.state.showUserMenu?this.hideUserMenu:this.showUserMenu},this.state.icon?s.a.createElement(P.d,{className:"nav-bar__login-icon"}):s.a.createElement(P.c,{className:"nav-bar__login-icon"}),t))),s.a.createElement(a.Fragment,null,s.a.createElement("header",{className:"nav-bar "+(this.state.sticked?"nav-bar--sticked":"")},s.a.createElement(M.b,{to:"/",style:{textDecoration:"none"}},s.a.createElement("div",{className:"logo"},s.a.createElement("div",{className:"logo__img"},s.a.createElement(T.c,{className:"logo__icon"})),s.a.createElement("div",{className:"logo__text"},"Baza Pyta\u0144"))),n),this.state.showUserMenu?s.a.createElement("div",{className:"modal",onClick:this.hideUserMenu}):null)}}]),n}(a.Component),W=Object(g.b)((function(e){return{isAuth:e.auth.isAuthenticated,isAdmin:e.auth.isAdmin,isPublisher:e.auth.isPublisher}}),{})(x),G=n(47),H=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={editMode:!1,firstName:"",lastName:"",city:""},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.isAuthenticated||this.props.history.push("/")}},{key:"render",value:function(){return this.props.isAuthenticated?s.a.createElement(a.Fragment,null,s.a.createElement("h1",{className:"heading-primary"},"Twoje konto"),s.a.createElement("div",{className:"account-info__box"},s.a.createElement("div",{className:"account-info__field"},s.a.createElement("span",{className:"account-info__field-title"},"Email:")," ",this.props.user.email),s.a.createElement("div",{className:"account-info__field"},s.a.createElement("span",{className:"account-info__field-title"},"Imi\u0119:")," ",this.props.user.firstName),s.a.createElement("div",{className:"account-info__field"},s.a.createElement("span",{className:"account-info__field-title"},"Nazwisko:")," ",this.props.user.lastName),s.a.createElement("div",{className:"account-info__field"},s.a.createElement("span",{className:"account-info__field-title"},"Miejsce zamieszkania:")," ",this.props.user.city),s.a.createElement("div",{className:"account-info__field"},s.a.createElement("span",{className:"account-info__field-title"},"Status:")," ",this.props.isAdmin?"Admin":this.props.isPublisher?"Recenzent":"U\u017cytkownik"),s.a.createElement("div",{className:"account-info__btns"},s.a.createElement(h,{type:"short"},s.a.createElement(d.e,{className:"account-info__btn-icon"}),"\u2003\u2003 Edytuj dane"),s.a.createElement(h,{types:["short","delete"]},s.a.createElement(G.a,{className:"account-info__btn-icon"}),"\u2003\u2003 Usu\u0144 konto")))):s.a.createElement(a.Fragment,null)}}]),n}(a.Component),B=Object(g.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,user:e.auth.user,isAdmin:e.auth.isAdmin,isPublisher:e.auth.isPublisher}}),{})(H),Z=n(35),V=n.n(Z),X={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};V.a.setAppElement("#root");var K=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).defaultUsersPerPage=5,e.state={users:[],numOfUsers:5,filterInput:[],isFiltering:!1,isLoading:!0,showModal:!1,currentUser:null,modalMessage:"",upgrading:!0},e.loadMoreUsres=function(){var t=e.state.numOfUsers;e.setState({numOfUsers:t+5})},e.resetUsersNum=function(){e.state.numOfUsers!==e.defaultUsersPerPage&&e.setState({numOfUsers:e.defaultUsersPerPage})},e.onFilterChange=function(t){t.length&&t[0].length>1?e.setState({filterInput:t,isFiltering:!0}):e.setState({filterInput:t,isFiltering:!1})},e.onDeleteUser=function(){},e.onDowngradeUser=function(t){e.setState({isLoading:!0,showModal:!1}),t.isAdmin?e.props.removeAdmin(t.email,t.id):t.isPublisher&&e.props.removePublisher(t.email,t.id)},e.onUpgradeUser=function(t){e.setState({isLoading:!0,showModal:!1}),t.isAdmin||(t.isPublisher?e.props.addAdmin(t.email,t.id):e.props.addPublisher(t.email,t.id))},e.onConfirmUpgradeUser=function(t){var n=e.state.users.find((function(e){return e.id===t})),a="Czy na pewno chcesz mianowa\u0107 ".concat(n.firstName," ").concat(n.lastName," recenzentem?");n.isPublisher&&(a="Czy na pewno chcesz mianowa\u0107 ".concat(n.firstName," ").concat(n.lastName," administratorem?")),e.setState({showModal:!0,currentUser:Object(S.a)({},n),modalMessage:a,upgrading:!0})},e.onConfirmDowngradeUser=function(t){var n=e.state.users.find((function(e){return e.id===t})),a="Czy na pewno chcesz USUN\u0104\u0106 u\u017cytkownika ".concat(n.firstName," ").concat(n.lastName,"?");n.isAdmin?a="Czy na pewno chcesz usun\u0105\u0107 status ADMINISTRATORA u\u017cytkownikowi ".concat(n.firstName," ").concat(n.lastName,"?"):n.isPublisher&&(a="Czy na pewno chcesz usun\u0105\u0107 status recenzenta u\u017cytkownikowi ".concat(n.firstName," ").concat(n.lastName,"?")),e.setState({showModal:!0,currentUser:Object(S.a)({},n),modalMessage:a,upgrading:!1})},e.onCloseModal=function(){e.setState({showModal:!1}),e.setState({currentUser:null})},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;O.ref("users").on("value",(function(t){var n=[],a=t.val();for(var s in a){var i={firstName:a[s].firstName,lastName:a[s].lastName,email:a[s].email,city:a[s].city,phone:a[s].phone,id:s,isPublisher:!0===a[s].isPublisher,isAdmin:!0===a[s].isAdmin};n.push(i)}e.setState({users:n,isLoading:!1})}))}},{key:"componentWillUnmount",value:function(){O.ref("users").off()}},{key:"render",value:function(){var e=this,t=this.state.users.filter((function(t){return t.email!==e.props.myEmail})).filter((function(t){if(!e.state.isFiltering)return!0;e.resetUsersNum();var n=!1;return e.state.filterInput.forEach((function(e){t.firstName.toLowerCase().includes(e.toLowerCase())&&e.length>1&&(n=!0),t.lastName.toLowerCase().includes(e.toLowerCase())&&e.length>1&&(n=!0),t.email.toLowerCase().includes(e.toLowerCase())&&e.length>1&&(n=!0),t.city.toLowerCase().includes(e.toLowerCase())&&e.length>1&&(n=!0)})),n})).slice(0,this.state.numOfUsers).map((function(t){return s.a.createElement("div",{key:t.id,id:t.id,className:"users-box__user"},s.a.createElement("div",{className:"users-box__user-icon-box"},s.a.createElement("div",{className:"users-box__user-icon-container"},t.isAdmin?s.a.createElement(d.e,{className:"users-box__user-icon"}):t.isPublisher?s.a.createElement(T.b,{className:"users-box__user-icon"}):s.a.createElement(P.c,{className:"users-box__user-icon"}))),s.a.createElement("div",{className:"users-box__user-info-box"},s.a.createElement("div",{className:"users-box__user-name"},t.firstName," ",t.lastName),s.a.createElement("div",{className:"users-box__user-info"},s.a.createElement("div",{className:"users-box__user-info-field"},"Email: \u2003",t.email),s.a.createElement("div",{className:"users-box__user-info-field"},"Miasto:\u2003",t.city),s.a.createElement("div",{className:"users-box__user-info-field"},"Status:\u2003",t.isAdmin?"Administrator":t.isPublisher?"Recenzent":"U\u017cytkownik"))),s.a.createElement("div",{className:"users-box__btns"},s.a.createElement("button",{className:"users-box__btn ".concat(t.isAdmin?"users-box__btn--disabled":t.isPublisher?"users-box__btn--premium":"users-box__btn--confirm"),onClick:function(){return e.onConfirmUpgradeUser(t.id)}},s.a.createElement(d.f,{className:"users-box__btn-icon"})),s.a.createElement("button",{className:"users-box__btn users-box__btn--delete",onClick:function(){return e.onConfirmDowngradeUser(t.id)}},t.isAdmin||t.isPublisher?s.a.createElement(T.a,{className:"users-box__btn-icon"}):s.a.createElement(d.c,{className:"users-box__btn-icon"}))))}));return s.a.createElement("div",{className:"users-box"},s.a.createElement(V.a,{isOpen:this.state.showModal,style:X,contentLabel:"Example Modal",overlayClassName:"modal__overlay",onRequestClose:this.onCloseModal},s.a.createElement("div",{className:"modal__window"},s.a.createElement("h2",null,this.state.modalMessage),s.a.createElement("div",{className:"modal__btns"},s.a.createElement(h,{type:"short",onClick:function(){return e.state.upgrading?e.onUpgradeUser(e.state.currentUser):e.onDowngradeUser(e.state.currentUser)}},"Tak"),s.a.createElement(h,{types:["delete","short"],onClick:this.onCloseModal},"Anuluj")))),s.a.createElement(p,{placeholder:"Szukaj u\u017cytkownik\xf3w",onChange:this.onFilterChange}),this.state.isLoading?s.a.createElement("div",{className:"u-centered"},s.a.createElement(E,null)):t,s.a.createElement(h,{onClick:this.loadMoreUsres,className:this.state.numOfUsers>=this.state.users.length?"btn--grey":""},"Za\u0142aduj wi\u0119cej uzytkownik\xf3w"))}}]),n}(a.Component),J=Object(g.b)((function(e){return{myEmail:e.auth.user?e.auth.user.email:""}}),{addPublisher:function(e,t){return function(n){console.log("adding"),j.httpsCallable("addPublisherRole")({email:e}).then((function(){O.ref("users/".concat(t)).update({isPublisher:!0}).catch((function(e){n(A(e.message,e.code))})),console.log("added")})).catch((function(e){n(A(e.message,e.code))}))}},removePublisher:function(e,t){return function(n){j.httpsCallable("removePublisherRole")({email:e}).then((function(){O.ref("users/".concat(t)).update({isPublisher:!1}).catch((function(e){n(A(e.message,e.code))}))})).catch((function(e){n(A(e.message,e.code))}))}},addAdmin:function(e,t){return function(n){console.log("adding admin"),j.httpsCallable("addAdminRole")({email:e}).then((function(){O.ref("users/".concat(t)).update({isAdmin:!0}).catch((function(e){n(A(e.message,e.code))})),console.log("added admin")})).catch((function(e){n(A(e.message,e.code))}))}},removeAdmin:function(e,t){return function(n){j.httpsCallable("removeAdminRole")({email:e}).then((function(){O.ref("users/".concat(t)).update({isAdmin:!1}).catch((function(e){n(A(e.message,e.code))}))})).catch((function(e){n(A(e.message,e.code))}))}}})(K),Y=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={users:[]},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.isAdmin||this.props.history.push("/")}},{key:"render",value:function(){return s.a.createElement("div",{className:"admin-dash"},s.a.createElement("h1",{className:"heading-primary"},"Zarz\u0105dzaj u\u017cytkownikami"),s.a.createElement(J,null))}}]),n}(a.Component),$=Object(g.b)((function(e){return{isAdmin:e.auth.isAdmin}}),{})(Y),ee=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;C.onAuthStateChanged((function(t){console.log(t),e.props.loadUser(t)}))}},{key:"render",value:function(){return s.a.createElement(a.Fragment,null,s.a.createElement("main",{className:"main"},s.a.createElement("section",{className:"questions"},s.a.createElement(W,null),s.a.createElement("div",{className:"content-container"},s.a.createElement(R.c,null,s.a.createElement(R.a,{path:"/login",component:L}),s.a.createElement(R.a,{path:"/account",component:B}),s.a.createElement(R.a,{path:"/admin",component:$}),s.a.createElement(R.a,{path:"/prywatne",render:function(e){return s.a.createElement(I,Object.assign({},e,{type:"private"}))}}),s.a.createElement(R.a,{path:"/recenzje",render:function(e){return s.a.createElement(I,Object.assign({},e,{type:"review"}))}}),s.a.createElement(R.a,{exact:!0,path:"/",component:I}),s.a.createElement(R.a,{path:"/pytania",component:I}))))),s.a.createElement(Q,null))}}]),n}(a.Component),te=Object(g.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated}}),{loadUser:function(e){return function(e){var t=C.currentUser;t?(t.getIdTokenResult().then((function(t){console.log("CLAIMS: ",t.claims),t.claims.admin?e({type:"ADMIN_LOADED"}):t.claims.publisher&&e({type:"PUBLISHER_LOADED"})})).catch((function(t){e({type:"PUBLISHER_FAIL"})})),O.ref("users/".concat(t.uid)).once("value").then((function(e){return e.val()})).then((function(n){if(console.log(n),!n)throw new Error("User is not defined in database");t.firstName=n.firstName||"brak informacji",t.lastName=n.lastName||"brak informacji",t.city=n.city||"brak informacji",console.log(t),e({type:"USER_LOADED",payload:t})})).catch((function(n){e(A(n.message,n.code)),t.firstName="brak informacji",t.lastName="brak informacji",t.city="brak informacji",e({type:"USER_LOADED",payload:t})}))):e({type:"AUTH_ERROR"})}}})(ee),ne=n(20),ae=n(48),se={isAuthenticated:null,isLoading:!1,user:null,isAdmin:!1,isPublisher:!1},ie=n(49),oe={items:[],item:{}},re={msg:{},status:null,id:null},ce=Object(ne.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"USER_LOADING":return Object(S.a)({},e,{isLoading:!0});case"USER_LOADED":return Object(S.a)({},e,{isLoading:!1,isAuthenticated:!0,user:t.payload});case"LOGIN_SUCCESS":case"REGISTER_SUCCESS":return Object(S.a)({},e,{isLoading:!1,isAuthenticated:!0,user:t.payload});case"LOGIN_FAIL":case"AUTH_ERROR":case"REGISTER_FAIL":case"LOGOUT_SUCCESS":return Object(S.a)({},e,{user:null,isLoading:!1,isAuthenticated:!1,isAdmin:!1,isPublisher:!1});case"ADMIN_LOADED":return Object(S.a)({},e,{isAdmin:!0,isPublisher:!0});case"PUBLISHER_LOADED":return Object(S.a)({},e,{isAdmin:!1,isPublisher:!0});case"ADMIN_FAIL":return Object(S.a)({},e,{isAdmin:!1});case"PUBLISHER_FAIL":return Object(S.a)({},e,{isPublisher:!1,isAdmin:!1});default:return e}},questions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0,n=Object(ie.a)(e.items);switch(t.type){case"FETCH_QUESTIONS":return Object(S.a)({},e,{items:t.payload});case"NEW_PRIVATE_QUESTION":case"NEW_PUBLIC_QUESTION":return n.push(t.payload),Object(S.a)({},e,{items:n,item:t.payload});case"DELETE_QUESTION":return n=n.filter((function(e){return e.id!==t.payload})),Object(S.a)({},e,{items:n});case"UPDATE_QUESTION":var a=n.findIndex((function(e){return e.id===t.payload.id}));return n[a]=Object(S.a)({},n[a],{},t.payload.question),Object(S.a)({},e,{items:n,item:n[a]});default:return e}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ERRORS":return{msg:t.payload.msg,status:t.payload.status,id:t.payload.id};case"CLEAR_ERRORS":return Object(S.a)({},re);default:return Object(S.a)({},e)}}}),le=[ae.a],ue=Object(ne.e)(ce,{},Object(ne.d)(ne.a.apply(void 0,le),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()));var me=function(){return s.a.createElement(g.a,{store:ue},s.a.createElement(M.a,null,s.a.createElement("div",{className:"App"},s.a.createElement(te,null))))};o.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(me,null)),document.getElementById("root"))}},[[50,1,2]]]);
//# sourceMappingURL=main.3f41d75c.chunk.js.map